{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="flex-1 flex flex-col h-full overflow-y-auto bg-background-light dark:bg-background-dark">
        <main class="flex-1 p-8">
            <div class="max-w-6xl mx-auto">

                <div class="flex flex-wrap justify-between items-end gap-4 mb-8">
                    <div class="flex flex-col gap-2">
                        <h1 class="text-gray-900 dark:text-white text-3xl font-black uppercase tracking-tight">Plany Żywieniowe</h1>
                        <p class="text-gray-500 dark:text-gray-400">Zarządzaj dostępnymi posiłkami i stawkami dziennymi dla dzieci.</p>
                    </div>
                    {% if active_role == 'director' %}
                        <a href="{% url 'add_meal' %}" class="flex items-center gap-2 rounded-xl bg-primary px-6 py-3 text-white font-bold shadow-lg hover:bg-primary/90 transition-all">
                            <span class="material-symbols-outlined">add_circle</span>
                            Dodaj Nowy Posiłek
                        </a>
                    {% endif %}
                </div>



                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                    {% for meal in page_obj %}
                        <div class="bg-white dark:bg-[#0f1d0f] rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 overflow-hidden hover:shadow-md transition-shadow group">
                            <div class="h-40 bg-gray-50 dark:bg-gray-800 flex items-center justify-center border-b border-gray-100 dark:border-gray-800 relative">
                                {% if meal.photo %}
                                    <img src="{{ meal.photo.meal_photos.url }}" alt="{{ meal.name }}" class="h-24 w-24 object-contain group-hover:scale-110 transition-transform">
                                {% else %}
                                    <span class="material-symbols-outlined text-6xl text-gray-300">restaurant</span>
                                {% endif %}
                                <div class="absolute top-3 right-3 bg-primary text-white text-xs font-black px-2 py-1 rounded-lg shadow-sm">
                                    {{ meal.per_day }} zł
                                </div>
                            </div>

                            <div class="p-5 text-center">
                                <h3 class="text-lg font-bold text-gray-900 dark:text-white mb-4 truncate">{{ meal.name }}</h3>
                                <a href="{% url 'meal_details' meal.id %}" class="inline-block w-full py-2.5 rounded-xl border-2 border-primary text-primary font-bold hover:bg-primary hover:text-white transition-all text-sm">
                                    SZCZEGÓŁY
                                </a>
                            </div>
                        </div>
                    {% empty %}
                        <div class="col-span-full p-20 text-center bg-white dark:bg-[#0f1d0f] rounded-2xl border-2 border-dashed border-gray-200 dark:border-gray-800">
                            <span class="material-symbols-outlined text-6xl text-gray-300 mb-4">no_meals</span>
                            <p class="text-gray-500 font-medium">Brak zdefiniowanych posiłków.</p>
                        </div>
                    {% endfor %}
                </div>

                {% if page_obj.has_other_pages %}
                    <div class="mt-12 flex justify-center items-center gap-4">
                        {% if page_obj.has_previous %}
                            <a href="?page={{ page_obj.previous_page_number }}" class="size-12 flex items-center justify-center rounded-full border border-gray-200 text-gray-400 hover:text-primary transition-all">
                                <span class="material-symbols-outlined">arrow_back</span>
                            </a>
                        {% endif %}

                        <span class="size-12 flex items-center justify-center rounded-full bg-primary text-white font-black shadow-md">{{ page_obj.number }}</span>

                        {% if page_obj.has_next %}
                            <a href="?page={{ page_obj.next_page_number }}" class="size-12 flex items-center justify-center rounded-full border border-gray-200 text-gray-400 hover:text-primary transition-all">
                                <span class="material-symbols-outlined">arrow_forward</span>
                            </a>
                        {% endif %}
                    </div>
                {% endif %}

            </div>
        </main>
    </div>
{% endblock %}