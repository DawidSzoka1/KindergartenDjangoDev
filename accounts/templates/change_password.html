{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block content %}
    <div class="flex-1 flex flex-col h-full overflow-y-auto bg-background-light dark:bg-background-dark">
        <main class="flex-1 p-4 lg:p-10 flex justify-center">
            <div class="w-full max-w-[800px] flex flex-col gap-8">

                <div class="flex flex-col gap-3 border-b border-gray-200 dark:border-gray-800 pb-6">
                    <h1 class="text-gray-900 dark:text-white tracking-tight text-3xl lg:text-4xl font-bold leading-tight">Zmiana Hasła</h1>
                    <p class="text-gray-500 dark:text-gray-400 text-base font-normal leading-normal max-w-2xl">
                        Zaktualizuj swoje hasło, aby zapewnić bezpieczeństwo konta w systemie KinderManage.
                    </p>
                </div>

                <div class="bg-white dark:bg-[#0f1d0f] rounded-xl p-6 lg:p-8 shadow-sm border border-gray-200 dark:border-gray-800">
                    <form method="POST" class="flex flex-col gap-6">
                        {% csrf_token %}

                        <div class="custom-crispy-styling">
                            {{ password_form|crispy }}
                        </div>

                        <div class="flex flex-col-reverse sm:flex-row gap-4 pt-4 mt-2">
                            <a href="{% if perms.director.is_director %}{% url 'director_profile' %}{% elif perms.teacher.is_teacher %}{% url 'teacher-profile' pk=user.employee.id %}{% elif perms.parent.is_parent %}{% url 'parent_profile' user.parenta.id %}{% else %}{% url 'home_page' %}{% endif %}"
                               class="flex-1 sm:flex-none px-6 h-12 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 text-gray-700 font-bold text-sm transition-colors flex items-center justify-center">
                                Anuluj
                            </a>

                            <button type="submit" class="flex-1 sm:flex-none px-8 h-12 rounded-lg bg-primary hover:bg-primary/90 text-white font-bold text-sm shadow-md transition-all flex items-center justify-center gap-2">
                                <span class="material-symbols-outlined text-[20px]">save</span>
                                Zaktualizuj hasło
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </main>
    </div>

    <style>
        /* Stylowanie etykiet i pól */
        .custom-crispy-styling label { font-weight: 700; color: #6b7280; text-transform: uppercase; font-size: 0.75rem; margin-bottom: 0.5rem; display: block; }
        .custom-crispy-styling input {
            width: 100%; border-radius: 0.5rem; border: 1px solid #d1d5db; padding: 0.75rem; background-color: white;
            transition: all 0.2s;
        }
        .custom-crispy-styling input:focus { border-color: #a78bfa; ring: 2px; ring-color: #a78bfa; outline: none; }
        .dark .custom-crispy-styling input { background-color: #1a2e1a; border-color: #374151; color: white; }

        /* Ukrycie/poprawa wyglądu brzydkich komunikatów pomocy Django pod polami */
        .custom-crispy-styling .help-block,
        .custom-crispy-styling .text-muted {
            font-size: 0.7rem;
            color: #9ca3af !important;
            margin-top: 0.25rem;
            display: block;
            line-height: 1.2;
            font-weight: 400;
            text-transform: none; /* Wyłączenie uppercase dla czytelności */
        }

        /* Jeśli chcesz całkowicie ukryć te podpowiedzi (bo masz je w ramce niżej), odkomentuj poniższe: */
        /* .custom-crispy-styling .help-block { display: none; } */
    </style>
{% endblock %}